1.质量检查：
①个体缺失和SNP的缺失
去除在大部分受试者中都缺失的snp；再去除基因型缺失较大的个体

②性别差异：
检查plink文件中记载的性别信息是否跟样品的基因组凸显的性别信息是否吻合；原理就是根据X染色体杂合度/纯合率检查数据集中记录的个体性别与遗传性别之间的差异（植物不好做这个）

③maf 最小等位基因频率
过于低的maf检测SNP-表型关联的能力，也容易出现基因分型错误。 

④HWE检验
检验分型是否错误。对于显性隐性性状文章建议排除病例组中HWE检验pvalue小于1e-10的标记，和控制组中 HWE检验pvalue小于1e-6的标记。对于数量性状来说，我们推荐HWE检验pvalue小于1e-6

⑤杂合率
去除具有较高或者较低杂合率的个体阈值设置。我们建议去除偏离样本的杂合率平均值±3 SD的个体。

⑥亲缘性
计算两两样本直接的血缘同一性。使用独立的SNP进行此项分析，并且将它限制在常染色体中。隐秘相关性可能会干扰关联分析。 

⑦群体分层
如果一个样本包括了多个种群（例如 南坡北坡），我们建议将这些种群分别分开后，在各自的种群中进行关联分析，并且使用合适的方法来整合这些结果（例如可以使用meta分析）
目前有很多方法可以用来校正群体结构分层。在本篇文章中，我们以PLINK软件中包含的多维缩放法（MDS）来举例说明 如何进行群体结构分层。
这个分析做的事情：举例：在一个包含了亚洲和欧洲人种的遗传研究中，MDS计算就会显示亚洲人之间的遗传相似性会高于欧洲人。通过这一步可以有效的找到那些偏离整体目标群体的游离样本。这些游离样本我们在之后都会去除。二元结果测量

2. 终于开始关联分析了：
①显性隐性性状
在PLINK软件中，snp和二元性状（值1 =未受影响，值2 =受影响; 0和-9表示缺失;这些PLINK中的默认选项是可以更改的）的关联检验，可以使用参数 --assoc（卡方检验） 或者 --logistic（回归分析），后者snp和数量性状之间的关联检验可以使用参数 --assoc 或者 --linear 来完成。
②数量性状的关联
当PLINK检测到数量性状时（例如值超过了1，2，0 或者是缺失），--assoc参数会自动的使用t检验的渐进版本来比较两个均值。这个选项不允许使用协变量。
而 --linear 参数把每个独立的SNP作为预测因子，执行线性回归分析。和--logistic选项类似，--linear选项可以使用协变量，但是执行速度比-assoc选项要慢一些更灵活，但是跑得慢。

3. 检验：
目前有三种方法来检测全基因组范围的显著性：Bonferroni校正，Benjamini-Hochberg错误发现率（FDR）和置换检验（permutation testing）






